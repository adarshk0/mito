function dydt = myo_odefun(t,y, CONSTANTS)
	ALGEBRAIC = zeros(11,1);
	dydt = zeros(17,1);
	
	spike = 0;
	tin = mod(t,0.18);
	if tin<0.03 || abs(tin-0.03)<1e-12
		spike = tin/0.03;
	elseif (0.03< tin < 0.06)
		spike = (0.03-tin)./0.06;
	else
		spike = 0;
	end

	ALGEBRAIC(2) = spike*CONSTANTS(18)./(1+( CONSTANTS(17).*y(6).*y(2))./y(1));
	ALGEBRAIC(3) = ALGEBRAIC(2).*1e6;
	ALGEBRAIC(4) = ALGEBRAIC(3);
	dydt(6) = ( CONSTANTS(26).*ALGEBRAIC(4))./1000.00;
	ALGEBRAIC(5) = y(1)./(1+CONSTANTS(20)./CONSTANTS(19));
	ALGEBRAIC(6) = y(1) - ALGEBRAIC(5);
	ALGEBRAIC(7) = y(2)./(1+CONSTANTS(20)./CONSTANTS(21));
	ALGEBRAIC(8) = y(2) - ALGEBRAIC(7);
	ALGEBRAIC(9) = 1+y(5)./CONSTANTS(3)+y(4)./CONSTANTS(7)+ ALGEBRAIC(6).*(1./CONSTANTS(2)+y(5)./( CONSTANTS(2).*CONSTANTS(4)))+ ALGEBRAIC(8).*(1./CONSTANTS(5)+y(4)./( CONSTANTS(7).*CONSTANTS(23))+y(5)./( CONSTANTS(5).*CONSTANTS(6)));
	ALGEBRAIC(10) = (( CONSTANTS(9).*ALGEBRAIC(6).*y(5))./( CONSTANTS(2).*CONSTANTS(4)) - ( CONSTANTS(10).*ALGEBRAIC(8).*y(4))./( CONSTANTS(5).*CONSTANTS(8)))./ALGEBRAIC(9);
	dydt(4) = ( CONSTANTS(24).*ALGEBRAIC(10))./1000.00;
	dydt(5) = (  - CONSTANTS(24).*ALGEBRAIC(10))./1000.00;
	ALGEBRAIC(11) =  CONSTANTS(11).*ALGEBRAIC(7).*ALGEBRAIC(8) -  CONSTANTS(12).*ALGEBRAIC(6).*y(3);
	dydt(1) = ((  - CONSTANTS(24).*ALGEBRAIC(10)+ CONSTANTS(25).*ALGEBRAIC(11)) -  CONSTANTS(26).*ALGEBRAIC(4))./1000.00;
	dydt(2) = (( CONSTANTS(24).*ALGEBRAIC(10) -  2.*CONSTANTS(25).*ALGEBRAIC(11))+ CONSTANTS(26).*ALGEBRAIC(4))./1000.00;
	dydt(3) = ( CONSTANTS(25).*ALGEBRAIC(11))./1000.00;
	dydt = 1e3*dydt;
end