function dydt = mito_odefun(t, y, CONSTANTS, isOnBoundary)
    
    ALGEBRAIC = zeros(35,1);
    dydt = zeros(16,1);
    ALGEBRAIC(1) = y(2)./(1+CONSTANTS(13)./CONSTANTS(12));
    ALGEBRAIC(2) = y(15);
    ALGEBRAIC(3) = y(1)./(1+CONSTANTS(13)./CONSTANTS(14));
    ALGEBRAIC(4) = y(1) - ALGEBRAIC(3);
    ALGEBRAIC(5) = y(2) - ALGEBRAIC(1);
    ALGEBRAIC(6) = 1+y(5)./CONSTANTS(9)+y(4)./CONSTANTS(10)+ (ALGEBRAIC(4)./CONSTANTS(3)+ALGEBRAIC(4)./CONSTANTS(4)).*(1+y(5)./CONSTANTS(8))+ (ALGEBRAIC(5)./CONSTANTS(5)+ALGEBRAIC(5)./CONSTANTS(6)).*(1+y(4)./CONSTANTS(7)+y(5)./CONSTANTS(11));
    ALGEBRAIC(7) = (( CONSTANTS(1).*ALGEBRAIC(4).*y(5))./( CONSTANTS(4).*CONSTANTS(8)) - ( CONSTANTS(2).*ALGEBRAIC(5).*y(4))./( CONSTANTS(6).*CONSTANTS(7)))./ALGEBRAIC(6);
    ALGEBRAIC(8) =  CONSTANTS(23).*y(7)+ CONSTANTS(22).*log(abs(CONSTANTS(76)./y(8)));
    ALGEBRAIC(9) = (CONSTANTS(27) - CONSTANTS(22).*log( (y(8).*10).^2)) -  (CONSTANTS(22)./2).*log(y(13)./1e6);
    ALGEBRAIC(10) =   - 0.65.*y(7);
    ALGEBRAIC(11) =  0.35.*y(7);
    ALGEBRAIC(12) = ( y(6).*CONSTANTS(76))./(CONSTANTS(76)+CONSTANTS(71));
    ALGEBRAIC(13) = ( y(10).*y(8))./(y(8)+CONSTANTS(71));
    ALGEBRAIC(14) = ( CONSTANTS(53).*( y(8).*ALGEBRAIC(12) -  CONSTANTS(76).*ALGEBRAIC(13)))./(ALGEBRAIC(12)+CONSTANTS(45));
    ALGEBRAIC(15) =  CONSTANTS(58).*( CONSTANTS(35).*y(2).*y(2) -  y(3).*y(1));
    ALGEBRAIC(16) = ( CONSTANTS(55).*y(7).*( CONSTANTS(76).*exp(( CONSTANTS(23).*y(7))./CONSTANTS(22)) - y(8)))./(exp(( CONSTANTS(23).*y(7))./CONSTANTS(22)) - 1);
    ALGEBRAIC(17) = ( CONSTANTS(56).*y(7).*( CONSTANTS(74).*exp(( CONSTANTS(23).*y(7))./CONSTANTS(22)) - y(14)))./(exp(( CONSTANTS(23).*y(7))./CONSTANTS(22)) - 1);
    ALGEBRAIC(18) =  CONSTANTS(54).*( CONSTANTS(74).*y(8) -  y(14).*CONSTANTS(76));
    ALGEBRAIC(19) = CONSTANTS(40) - y(9);
    ALGEBRAIC(20) = ( CONSTANTS(47).*( CONSTANTS(46).*ALGEBRAIC(19) - y(9)).*(1+y(10)./CONSTANTS(41)))./(1+y(10)./CONSTANTS(42));
    ALGEBRAIC(21) = CONSTANTS(39) - y(11);
    ALGEBRAIC(22) = (CONSTANTS(25) -  CONSTANTS(22).*log( abs(y(8).*10))) -  CONSTANTS(22).*log(ALGEBRAIC(21)./y(11));
    ALGEBRAIC(23) =  CONSTANTS(48).*( exp( - (ALGEBRAIC(22)+ 4.*ALGEBRAIC(8))./CONSTANTS(22)).*y(9) - ALGEBRAIC(19));
    ALGEBRAIC(24) = (CONSTANTS(26)+ CONSTANTS(22).*log( (y(8).*10).^2)) -  CONSTANTS(22).*log(y(11)./ALGEBRAIC(21));	ALGEBRAIC(25) = CONSTANTS(38) - y(12);
    ALGEBRAIC(26) =  (( CONSTANTS(49).*(1+y(10)./CONSTANTS(43)))./(1+y(10)./CONSTANTS(44))).*( exp( - ((ALGEBRAIC(24)+ 4.*ALGEBRAIC(8)) -  2.*CONSTANTS(23).*y(7))./( 2.*CONSTANTS(22))).*ALGEBRAIC(25) - y(12));
    ALGEBRAIC(27) =  (( (CONSTANTS(50)./(1+CONSTANTS(60)./y(13))).*y(12))./CONSTANTS(38)).*( exp( - (ALGEBRAIC(9)+ 2.*ALGEBRAIC(8))./( 2.*CONSTANTS(22))).*y(12) -  ALGEBRAIC(25).*exp(( CONSTANTS(23).*y(7))./CONSTANTS(22)));
    ALGEBRAIC(28) = y(15)./(1+CONSTANTS(66)./CONSTANTS(65));
    ALGEBRAIC(29) = ALGEBRAIC(27)*0.054922;
    ALGEBRAIC(30) = y(15) - ALGEBRAIC(28);
    ALGEBRAIC(31) = y(16)./(1+CONSTANTS(66)./CONSTANTS(67));
    if ALGEBRAIC(1)>CONSTANTS(63) || ALGEBRAIC(3)>CONSTANTS(63)
        ALGEBRAIC(32) =( CONSTANTS(52).*(ALGEBRAIC(1)./(ALGEBRAIC(1)+ ALGEBRAIC(3).*exp((  - CONSTANTS(23).*ALGEBRAIC(11))./CONSTANTS(22))) - ALGEBRAIC(31)./(ALGEBRAIC(31)+ ALGEBRAIC(28).*exp((  - CONSTANTS(23).*ALGEBRAIC(10))./CONSTANTS(22)))).*ALGEBRAIC(1))./(CONSTANTS(57)+ALGEBRAIC(1));
    else
        ALGEBRAIC(32) = 0;
    end
    ALGEBRAIC(33) = y(16) - ALGEBRAIC(31);
    ALGEBRAIC(34) =  CONSTANTS(51).*( (( exp( - (CONSTANTS(28) -  CONSTANTS(24).*ALGEBRAIC(8))./CONSTANTS(22)).*CONSTANTS(34))./CONSTANTS(33)).*ALGEBRAIC(33).*y(10) -  ALGEBRAIC(30).*1e6);
    ALGEBRAIC(35) = ALGEBRAIC(34);
    ALGEBRAIC = real(ALGEBRAIC);
    dydt(1) = ((ALGEBRAIC(32)./CONSTANTS(75) - ALGEBRAIC(7)./CONSTANTS(75))+ALGEBRAIC(15)./CONSTANTS(75));
    dydt(2) = ( - (( 2.*ALGEBRAIC(15))./CONSTANTS(75)+ALGEBRAIC(32)./CONSTANTS(75))+ALGEBRAIC(7)./CONSTANTS(75));
    dydt(3) = (ALGEBRAIC(15)./CONSTANTS(75));
    dydt(4) = (ALGEBRAIC(7)./CONSTANTS(75));
    dydt(5) = ( - ALGEBRAIC(7)./CONSTANTS(75));
    dydt(6) = ( - ALGEBRAIC(14)./CONSTANTS(75));
    dydt(7) = ((((( 4*ALGEBRAIC(23)+ 2*ALGEBRAIC(26)+ 4*ALGEBRAIC(27)) -  CONSTANTS(24).*ALGEBRAIC(34)) - ALGEBRAIC(32)) - ALGEBRAIC(16)) - ALGEBRAIC(17))./( CONSTANTS(64));
    dydt(8) = ( CONSTANTS(61).*y(8).*(((((ALGEBRAIC(20) -  5.00000.*ALGEBRAIC(23)) -  2.*ALGEBRAIC(26)) -  4.*ALGEBRAIC(27))+ (CONSTANTS(24) - 1).*ALGEBRAIC(34)+ 2.*ALGEBRAIC(14)+ALGEBRAIC(16)) - ALGEBRAIC(18)))./( CONSTANTS(69));
    dydt(9) = (ALGEBRAIC(20) - ALGEBRAIC(23))./( CONSTANTS(69));
    dydt(10) = ( - ALGEBRAIC(34)+ALGEBRAIC(14))./( CONSTANTS(69));
    dydt(11) = (ALGEBRAIC(23) - ALGEBRAIC(26))./( CONSTANTS(69));
    dydt(12) = ( 2.*ALGEBRAIC(26) -  2.*ALGEBRAIC(27))./( CONSTANTS(75));
    if isOnBoundary
        dydt(13) = 0;
    else
        dydt(13) =  - ALGEBRAIC(27)./( 2.*CONSTANTS(75));
    end
    dydt(14) = (ALGEBRAIC(18)+ALGEBRAIC(17))./( CONSTANTS(69));
    dydt(15) = (ALGEBRAIC(34) - ALGEBRAIC(32))./( CONSTANTS(69));
    dydt(16) = ( - ALGEBRAIC(34)+ALGEBRAIC(32))./( CONSTANTS(69));
end